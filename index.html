<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matrix 4.0</title>
    <link rel="icon" type="image/png" href="images/Favicon.png">
    <link rel="apple-touch-icon" href="images/Favicon.png">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600&family=Orbitron:wght@500;700;900&display=swap" rel="stylesheet">
    <link rel = "stylesheet" href = "style.css">
</head>

<body>

    <div id="bg-container">
        <div id="art-collage">
            <div class="collage-item item-1"></div>
            <div class="collage-item item-2"></div>
            <div class="collage-item item-3"></div>
            <div class="collage-item item-4"></div>
            <div class="collage-item item-5"></div>
            <div class="collage-item item-6"></div>
        </div>
        <div class="bg-tint"></div>
        <canvas id="matrixCanvas"></canvas>
    </div>

    <nav>
        <div class="logo">
            <img src="images/matrix_lead_logo.png" alt="LEAD Logo">
        </div>
        <div class="hamburger" id="hamburger-menu">
            <span></span><span></span><span></span>
        </div>
        <div class="nav-links" id="nav-menu">
            <a href="index.html" class="active">Home</a>
            <a href="events.html">Events</a>
            <a href="sponsors.html">Sponsors</a>
            <a href="contact_us.html">Contact Us</a>
        </div>
    </nav>

    <div class="hero-section">
        <div class="lead-fullform">
            <span>LEARN</span>
            <span>EMERGE</span>
            <span>ASPIRE</span>
            <span>DISCOVER</span>
        </div>
        <h1 class="hero-title">MATRIX 4.0</h1>
        
        <div class="typewriter-container">
            <h2 class="hero-subtitle">The Red Notice Protocol</h2>
        </div>

        <div class="timer-container">
            <div class="time-box">
                <div class="corner-bracket tl"></div><div class="corner-bracket tr"></div>
                <div class="corner-bracket bl"></div><div class="corner-bracket br"></div>
                <span class="time-value" id="days">00</span>
                <span class="time-label">Days</span>
            </div>
            <div class="time-box">
                <div class="corner-bracket tl"></div><div class="corner-bracket tr"></div>
                <div class="corner-bracket bl"></div><div class="corner-bracket br"></div>
                <span class="time-value" id="hours">00</span>
                <span class="time-label">Hours</span>
            </div>
            <div class="time-box">
                <div class="corner-bracket tl"></div><div class="corner-bracket tr"></div>
                <div class="corner-bracket bl"></div><div class="corner-bracket br"></div>
                <span class="time-value" id="minutes">00</span>
                <span class="time-label">Minutes</span>
            </div>
            <div class="time-box">
                <div class="corner-bracket tl"></div><div class="corner-bracket tr"></div>
                <div class="corner-bracket bl"></div><div class="corner-bracket br"></div>
                <span class="time-value" id="seconds">00</span>
                <span class="time-label">Seconds</span>
            </div>
        </div>

        <button class="cta-btn">Initiate Sequence</button>
    </div>

    <script>
        /* --- 1. RESPONSIVE HAMBURGER & INTERACTION (MATCHED TO CONTACT PAGE) --- */
        const hamburger = document.getElementById('hamburger-menu');
        const navMenu = document.getElementById('nav-menu');

        if(hamburger && navMenu){
            hamburger.addEventListener('click', () => {
                navMenu.classList.toggle('active');
                hamburger.classList.toggle('toggle');
            });

            document.querySelectorAll('.nav-links a').forEach(link => {
                link.addEventListener('click', function(e) {
                    // Match Contact Page Mobile Logic
                    if (window.innerWidth <= 968) {
                        e.preventDefault();
                        const href = this.getAttribute('href');
                        this.classList.add('nav-clicked');
                        setTimeout(() => {
                            window.location.href = href;
                            navMenu.classList.remove('active');
                            hamburger.classList.remove('toggle');
                            this.classList.remove('nav-clicked');
                        }, 800);
                    }
                });
            });
        }

        /* --- 2. OPTIMIZED MATRIX RAIN (FIXED: KEEPS BACKGROUND VISIBLE) --- */
        const canvas = document.getElementById('matrixCanvas');
        // FIX: Removed { alpha: false } to allow background images to show through!
        const ctx = canvas.getContext('2d'); 
        let width, height, columns, drops = [];
        const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ$#@&%';
        const fontSize = 14;
        let animationId;
        
        // Performance: Cap FPS to 30 to prevent mobile battery drain/lag
        let lastTime = 0;
        const fpsInterval = 1000 / 30; 

        function initDrops() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            columns = Math.ceil(width / fontSize);
            drops = [];
            for (let i = 0; i < columns; i++) {
                drops.push({
                    y: Math.random() * height,
                    direction: Math.random() > 0.4 ? 1 : -1,
                    speed: Math.random() * 0.15 + 0.05,
                    drift: (Math.random() - 0.5) * 0.2
                });
            }
        }

        function draw(timeStamp) {
            animationId = requestAnimationFrame(draw);

            // Throttle FPS
            const elapsed = timeStamp - lastTime;
            if (elapsed < fpsInterval) return;
            lastTime = timeStamp - (elapsed % fpsInterval);

            // Clear to transparent so background images show
            ctx.clearRect(0, 0, width, height);
            
            ctx.font = fontSize + 'px monospace';
            ctx.textAlign = 'center';
            
            for (let i = 0; i < drops.length; i++) {
                const drop = drops[i];
                
                if (drop.y < -50 || drop.y > height + 50) {
                      updateDropPosition(drop);
                      continue;
                }

                const hue = Math.random() > 0.8 ? 0 : (Math.random() > 0.5 ? 180 : 0);
                // Restored varying opacity for depth
                ctx.fillStyle = `hsla(${hue}, 100%, ${Math.floor(Math.random() * 40 + 60)}%, ${Math.random() * 0.4 + 0.2})`;
                
                const text = chars[Math.floor(Math.random() * chars.length)];
                const x = i * fontSize + (drop.y * drop.drift);
                
                ctx.fillText(text, x, drop.y);
                updateDropPosition(drop);
            }
        }

        function updateDropPosition(drop) {
            if (drop.direction === 1) {
                drop.y += fontSize * drop.speed;
                if (drop.y > height + fontSize && Math.random() > 0.98) { drop.y = -fontSize; drop.drift = (Math.random() - 0.5) * 0.2; }
            } else {
                drop.y -= fontSize * drop.speed;
                if (drop.y < -fontSize && Math.random() > 0.98) { drop.y = height + fontSize; drop.drift = (Math.random() - 0.5) * 0.2; }
            }
        }

        document.addEventListener('visibilitychange', () => {
            if (document.hidden) cancelAnimationFrame(animationId);
            else {
                lastTime = performance.now(); 
                animationId = requestAnimationFrame(draw);
            }
        });

        window.addEventListener('resize', () => {
            clearTimeout(window.resizeTimer);
            window.resizeTimer = setTimeout(initDrops, 200);
        });
        
        initDrops();
        requestAnimationFrame(draw);

        /* --- 3. LAG-FREE COUNTDOWN TIMER (FIXED BUG) --- */
        const countDownDate = new Date().getTime() + (14 * 24 * 60 * 60 * 1000); 
        
        // Cache DOM elements
        const dEl = document.getElementById("days");
        const hEl = document.getElementById("hours");
        const mEl = document.getElementById("minutes");
        const sEl = document.getElementById("seconds");
        const timerContainer = document.querySelector(".timer-container");

        function updateTimer() {
            const now = new Date().getTime();
            const distance = countDownDate - now;

            if (distance < 0) {
                if(timerContainer) timerContainer.innerHTML = "<h2 style='color:red; font-family:Orbitron'>PROTOCOL ENGAGED</h2>";
                return;
            }

            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            if(dEl) dEl.innerText = days < 10 ? "0" + days : days;
            if(hEl) hEl.innerText = hours < 10 ? "0" + hours : hours;
            if(mEl) mEl.innerText = minutes < 10 ? "0" + minutes : minutes;
            if(sEl) sEl.innerText = seconds < 10 ? "0" + seconds : seconds;
        }

        // Run immediately (Fixes start lag)
        updateTimer();

        // The Interval
        setInterval(updateTimer, 1000);

        // FIX: FORCE UPDATE ON TAB VISIBILITY (Fixes "58...pause...52" jump)
        let originalTitle = document.title; 
        window.addEventListener("visibilitychange", function() {
            if (document.hidden) {
                document.title = "Please come back! ðŸ”´";
            } else {
                document.title = originalTitle;
                // Force immediate update when user comes back to the tab
                updateTimer(); 
            }
        });
    </script>
</body>
</html>